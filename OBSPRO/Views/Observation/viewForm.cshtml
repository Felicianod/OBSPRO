@model OBSPRO.Models.OBSCollectionForm
@{
    ViewBag.Title = "Observation Collection Form View";
}
@{
    var qcounter = 1;
}
<style>
    .nomargin {
        margin: 0px 0px;
        padding: 2px 2px;
    }
    .answered {
       border-bottom:solid 1px #d6d6d6;
    }
    .unanswered {
        /*border: 1px dashed orange;
        border-radius: 8px;
        background-color: #fbf1f1;*/
        border-bottom:solid 1px #d6d6d6;
    }
    .btnOBS {
        /*box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);*/
        background-color: #1d5600;
        color:white;
        font-weight:bold;
        padding:5px;
        box-shadow: 1px 1px 10px #d0cccc, 0 2px 7px 0 #e3e0e0;
    }

    .btnOBS:hover {
        background-color: #2a7d00;
        color: #fed4d4;
        /*box-shadow: 0 4px 4px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);*/
        box-shadow: 1px 1px 10px red, 0 2px 7px 0 #00ac1b;
    }
    .btnOBS:focus { 
        color: white;
    }

    html, body {
        height:100%
    }
    .fake_textarea {
        border: 1px solid gray;
        border-radius: 4px;
        background-color: #ededed;
        padding:7px;
        margin: 0px 0px 6px 13px;
        width:96%;    
    }
    #overlay { 
        position:absolute;
        z-index:10;
        width:100%;
        height:100%;
        top:0;
        left:0;
        background-color:#f00;
        filter:alpha(opacity=10);
        -moz-opacity:0.1;
        opacity:0.1;
        cursor:pointer;
    } 

   .dialog {
       position:absolute;
       border:2px solid #3366CC;
       width:250px;
       height:120px;
       background-color:#ffffff;
       z-index:12;
   }
  .badge-outline {
      color: black;
      border: 1px solid #999;
      background-color: transparent;
  }
  fieldset.textComment {
      border: 3px double #d6d6d6;
      background-color: #f6fbfb;
      padding: 0 1.4em 0.6em 1.0em;
      margin: 0 0 0.7em 0;
      -webkit-box-shadow:  0px 0px 0px 0px #000;
              box-shadow:  0px 0px 0px 0px #000;
    
     -moz-border-radius:5px;  
     border-radius: 5px;  
     -webkit-border-radius: 5px;
  }

  legend.textComment {
     font-size: 1.0em !important;
     font-weight: bold !important;
     text-align: left !important;
     width:inherit; /* Or auto */
     padding:0 10px; /* To give a bit of padding on the left and right */
     border-bottom:none;
  }

    fieldset > legend {
        float:left;
        margin-top:-12px;
        background-color: #f6fbfb;
        padding: 0px 0px;
    }
    fieldset > legend + * {
        clear:both;
    }
</style>
<link href="~/Content/bootstrap-dialog.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap-dialog.js"></script>
<script src="~/Scripts/obsGlobal.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        init();
    });

    function init() {
        $('#overlay').click(function () { closeDialog(); })
    }

    function openDialog(element) {
        //this is the general dialog handler.
        //pass the element name and this will copy
        //the contents of the element to the dialog box
        alert("Opening Dialog");

        $('#overlay').css('height', $(document.body).height() + 'px');
        $('#overlay').show();
        //$('#dialog').html($(element).html());
        centerMe(element);
        //$('#dialog').show();
        element.show();
    }

    function closeDialog() {
        $('#overlay').hide();
        $('#content').hide();
        $('#contentB').hide();
        //$('#dialog').hide().html('');
    }

    function centerMe(element) {
        //pass element name to be centered on screen
        var pWidth = $(window).width();
        var pTop = $(window).scrollTop();
        var eWidth = element.width();
        var height = element.height();
        element.css('top', '130px');
        //$(element).css('top',pTop+100+'px')
        element.css('left', parseInt((pWidth / 2) - (eWidth / 2)) + 'px');
    }

</script>

<div style="max-width:1100px; margin:0 auto;">
  <section id="formHeader" style="position:fixed; top:71px; z-index:999; min-width:1100px" @*data-spy="affix" data-offset-top="10"*@>
        <div class="panel panel-info" style="margin:0px 0px; padding:2px 2px 10px 2px; z-index:998; border:none">
            <div class="panel-heading header" style="background-color:#b62525; color:white; padding:0px">
                <div class="row" style="text-align:center; margin:0px">
                    <div class="col-sm-1">
                        <span style="float:left"></span>
                    </div>
                    <div class="col-sm-7" style="margin:0 auto; padding:5px">
                        <h4 style="padding:0px; margin:0px"><b>@Model.colFormTitle</b></h4>
                        @if (!Model.colFormSubtitle.Equals("")) { <span>( @Model.colFormSubtitle )</span>}
                    </div>
                    <div class="col-sm-4" style="padding:0px">
                        <div class="row" style="margin-right:2px; padding:0px">
                            <div class="col-sm-9" style="padding-right:0px">
                                <span style="float:right; margin-right:10px; color:yellow"><b>Status: @Model.colFormStatus </b></span>
                            </div>
                            <div class="col-sm-3" style="padding-right:2px">
                                <button type="button" id="btnPrintForm" class="btn btnOBS" style="float:right">
                                    <span class="glyphicon glyphicon-print" aria-hidden="true"></span> Print
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-body content " style="background-color:#292222;color:white; padding:4px">
                <div class="row" style="padding:0px; margin:0; width:100%">
                    <div class="col-sm-4 nomargin" style="margin:0; ">
                        <div class="row" style="margin-left:6px"><span style="float:left"><b>Logistic Center: </b> @Model.lc_id </span></div>
                        <div class="row" style="margin-left:6px"><b>Started Observation at: </b> @Model.strColFormStartDateTime</div>
                    </div>

                    <div class="col-sm-4 nomargin" style="margin:0; ">
                        <div class="row" style="margin-left:6px"><b>Observer: </b> @Model.observerEmployeeFullName</div>
                        <div class="row" style="margin-left:6px"><b>Observation Submitted at: </b> @Model.strColFormSubmittedDateTime</div>
                    </div>

                    <div class="col-sm-4 nomargin " style="margin:0; border: 2px inset white;">
                        <div class="row" style="margin-left:10px"><b>Employee Observed: </b> <span style="color:gray">&nbsp;&nbsp;&nbsp;&nbsp; [ADP Id: @Model.observedADPID]</span> </div>
                        <div class="row">
                            <div class="col-sm-10 col-sm-offset-1">@*<b>Name: </b>*@ @Model.observedEmployeeFullName</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

  <section id="formBody" style="overflow-y:auto;" @*class="container-fluid"*@>
      <div style="font-size:medium; margin-bottom:5px; "> </div>
    @foreach (var sec in Model.sections)
    {
      <div class="panel panel-default" style="margin:0px 0px; ">
         <div class="panel-heading" style="background-color:#292222">
            <h4 class="panel-title" style="color:white">
                 @sec.sectionName
            </h4>
         </div>
          <div class="panel-body content" style="padding:0px;">
            @foreach (var quest in sec.questions)
            {                
                <div class="@quest.responseClass" style="margin: 1px 2px 0px 2px; padding:0px;">
                    @*------------------------------ QUESTION SECTION --------------------------------------------*@
                    <div class="row" style="font-weight:bold;margin:0px 5px 7px 8px; margin-top: 3px; padding:0px; ">
                        <div class="col-sm-10" style="margin:0px 0px; padding-left:3px">
                            <span style="font-size:large">@qcounter&nbsp;&nbsp;</span><span style="font-size:medium">@quest.questionText</span>
                        </div>
                        <div class="col-sm-2" style="margin:0px 0px">
                            @if (@quest.responseClass.Equals("unanswered"))
                                    { <span style="float:right; color:red; font-size:x-small; margin-right:20px">*Answer Pending</span> }
                        </div>
                    </div>
                    @*------------------------------ ANSWER SECTION ---------------------------------------------*@
                    <div class="row" style="margin:0px 0px 0px 25px; padding:0px;">
                        <div class="col-sm-11">
                            @if (quest.answerType == "FREE_TXT")
                            {// Show FREE TEXT ANSWER BOX
                                <fieldset class="textComment">
                                    <legend class="textComment">Answer</legend>
                                    @quest.comments.Trim()
                                </fieldset>
                            }
                            else
                            {
                                <ul class="list-inline">
                                    @foreach (var ans in quest.answers)
                                    {
                                        if (ans.isSelected)
                                        {
                                            <li><span class="badge" style="padding:6px">@ans.answerText</span></li>
                                        }
                                        else
                                        {
                                            <li>@ans.answerText</li>
                                        }
                                    }
                                </ul>
                            }
                        </div>

                        @if (quest.naSelected)
                        {
                            <div class="col-sm-1">
                                <span class="badge" style="padding:6px">N/A</span>
                            </div>
                        }
                        else
                        {
                            if (quest.showsNA.Equals("true"))
                            {
                                <div class="col-sm-1">
                                    <span class="badge badge-outline" style="padding:6px;">N/A</span>
                                </div>
                            }
                        }
                    </div>
                    @*------------------------------ ANSWER COMMENT SECTION ---------------------------------------------*@
                    @* ----  Display the Comment Box Only if the Question is not a FREE_TEXT question -----   *@
                    @if (quest.answerType != "FREE_TXT")
                    {
                        <div class="row" style="margin:0px 0px 0px 20px; padding:0px 0px 0px 0px; ">
                            @if (!String.IsNullOrEmpty(quest.comments))
                            {
                                <text>Must add Comment: </text>@quest.mustAddComment <text>Can Add: </text>@quest.canAddComment
                                <div class='fake_textarea'>
                                    <b>Comment: </b> @quest.comments
                                </div>
                            }
                        </div>
                    }
                </div>
                qcounter += 1;
            }
          </div>
      </div>
    }
  </section>
</div>

<br />
@*<input type="button" id="btnShowPopup" class="btn btn-success" value="Open Preview" data-toggle="modal" data-target="#myModal" />*@ 
@*<input type="button" id="btnShowPopup" class="btn btn-success" value="Open Preview" />*@ 
@*<div class="modal hide fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Form Print Preview</h3>
    </div>
    <div class="modal-body">
    </div>
</div>*@



@*<div id="cognosReport" style="display:none">
    <iframe name="myIframe" id="myIframe" style="border-style: none; width:100%;" height="1000" src="http://dsccognosdevws1.dsccorp.net/ibmcognos/cgi-bin/cognosisapi.dll?b_action=cognosViewer&ui.action=run&ui.object=%2fcontent%2ffolder%5b%40name%3d%27SDK%20Testing%27%5d%2freport%5b%40name%3d%27Observation%20Collection%20Form%27%5d&ui.name=Observation%20Collection%20Form&run.outputFormat=PDF&run.prompt=false&p_cfi_id=10353&CAMNamespace=DSCLogistics&CAMUsername=cog_sdk&CAMPassword=Cog4u2!&ui.backURL=%2fibmcognos%2fcgi-bin%2fcognosisapi.dll%3fb_action%3dxts.run%26m%3dportal%2fcc.xts%26m_folder%3diFA794FAF9D6A4AC6B67192521DB5FAD9"></iframe>
</div>*@


<div id="overlay" class="dialog" style="display:none"></div>
<div id="content" class="dialog" style="display:none">
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nisl felis, placerat in sollicitudin quis, hendrerit vitae diam. Nunc ornare iaculis urna.
</div>

<br />

@*<a href="www.msn.com" class="modalTrigger">Open Modal</a>*@
@*<a href="javascript:;//close me" onclick="openDialog($('#content'))">show dialog A</a>
    <br />
    <a href="javascript:;//close me" onclick="openDialog($('#contentB'))">show dialog B</a>
    <br />
    <br />
    <div id="dialog" class="dialog" style="display:none">
        This is a test!
    </div>
    

    <div id="contentB" class="dialog" style="display:none">
        Moooo mooo moo moo moo!!!
    </div>*@

<script>
    $(document).ready(function () {
        //Adjust or Set the correct Margin Height of the Form Body 
        $("#formBody").css("margin-top", $("#formHeader").outerHeight());

        //---------------------------------------------------------------------------
        $("#btnPrintForm").click(function (e) {
            e.preventDefault();

            //obsAlert('Preview Not available at this time!');
            //BootstrapDialog.alert("Hello!");
            //obsConfirm('Preview Not available at this time!');

            @*var cfiIf = @Model.obsColFormInstId;
            var url = "http://dsccognosdevws1.dsccorp.net/ibmcognos/cgi-bin/cognosisapi.dll?b_action=cognosViewer&ui.action=run&ui.object=%2fcontent%2ffolder%5b%40name%3d%27SDK%20Testing%27%5d%2freport%5b%40name%3d%27Observation%20Collection%20Form%27%5d&ui.name=Observation%20Collection%20Form&run.outputFormat=PDF&run.prompt=false&p_cfi_id=";
                url = url + cfiIf + "&ui=h1&cv.header=false&cv.toolbar=false" + "&CAMNamespace=DSCLogistics&CAMUsername=cog_sdk&CAMPassword=Cog4u2!&ui.backURL=%2fibmcognos%2fcgi-bin%2fcognosisapi.dll%3fb_action%3dxts.run%26m%3dportal%2fcc.xts%26m_folder%3diFA794FAF9D6A4AC6B67192521DB5FAD9";


            var urlProd = "http://dsccognosprdws1.dsccorp.net/ibmcognos/cgi-bin/cognosisapi.dll?b_action=cognosViewer&ui.action=run&ui.object=%2fcontent%2ffolder%5b%40name%3d%27SDK%20Testing%27%5d%2freport%5b%40name%3d%27Observation%20Collection%20Form%27%5d&ui.name=Observation%20Collection%20Form&run.outputFormat=PDF&run.prompt=false&p_cfi_id=";
                urlProd = urlProd + cfiIf + "&ui=h1&cv.header=false&cv.toolbar=false" + "&CAMNamespace=DSCLogistics&CAMUsername=cog_sdk&CAMPassword=Cog4u2!&ui.backURL=%2fibmcognos%2fcgi-bin%2fcognosisapi.dll%3fb_action%3dxts.run%26m%3dportal%2fcc.xts%26m_folder%3diCB0D41DDB02D428D8A78DB5821709948";*@

            //window.open(urlProd);
            //window.open(url, "popupWindow", "width=600,height=800,scrollbars=yes");

            window.open('@Model.colFormPrintPath');
        });
        //---------------------------------------------------------------------------

    });    
</script>
